<div class="friend-list">
  <div class="friend-header">
    <h2>Мои друзья</h2>
    <button (click)="toggleAddFriend()" class="add-friend-btn">
      {{ showAddFriend ? '✕ Отмена' : '+ Добавить друга' }}
    </button>
  </div>

  <!-- Панель добавления друзей -->
  <div *ngIf="showAddFriend" class="add-friend-panel">
    <h3>Поиск друзей</h3>
    <div class="search-container">
      <input 
        type="text" 
        [(ngModel)]="searchQuery" 
        (input)="searchUsers()"
        placeholder="Введите имя или фамилию..."
        class="search-input"
      >
      <div *ngIf="isSearching" class="search-loading">
        Поиск...
      </div>
    </div>

    <!-- Результаты поиска -->
    <div *ngIf="searchResults.length > 0" class="search-results">
      <h4>Найдено пользователей: {{ searchResults.length }}</h4>
      <div *ngFor="let user of searchResults" class="search-result-item">
        <div class="user-info">
          <div class="user-avatar">
            <img [src]="getAvatarUrl(user.id)" [alt]="user.firstName" (error)="handleImageError($event)">
          </div>
          <div class="user-details">
            <strong>{{ user.firstName }} {{ user.lastName }}</strong>
            <span>{{ user.email }}</span>
          </div>
        </div>
        <button 
          (click)="addFriend(user.id)" 
          [disabled]="isAlreadyFriend(user.id)"
          class="add-btn"
          [class.already-friend]="isAlreadyFriend(user.id)"
        >
          {{ isAlreadyFriend(user.id) ? 'Уже в друзьях' : 'Добавить' }}
        </button>
      </div>
    </div>

    <div *ngIf="searchQuery && !isSearching && searchResults.length === 0" class="no-results">
      Пользователи не найдены
    </div>
  </div>

  <!-- Список друзей -->
  <div *ngIf="isLoading" class="loading">
    Загрузка списка друзей...
  </div>

  <div *ngIf="!isLoading && friends.length === 0" class="no-friends">
    <p>У вас пока нет друзей</p>
    <p>Найдите друзей с помощью поиска выше!</p>
  </div>

  <div *ngFor="let friend of friends" class="friend-card">
    <div class="friend-info">
      <div class="friend-avatar">
        <img [src]="getAvatarUrl(friend.id)" [alt]="friend.firstName" (error)="handleImageError($event)">
      </div>
      <div class="friend-details">
        <h4>{{ friend.firstName }} {{ friend.lastName }}</h4>
        <p>{{ friend.email }}</p>
      </div>
    </div>
    <button (click)="openChat(friend.id)" class="chat-btn">
      Написать сообщение
    </button>
  </div>
</div>
